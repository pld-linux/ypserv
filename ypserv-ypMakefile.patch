diff -urN ypserv-1.3.10.orig/ypMakefile.in ypserv-1.3.10/ypMakefile.in
--- ypserv-1.3.10.orig/ypMakefile.in	Fri Dec 10 14:46:48 1999
+++ ypserv-1.3.10/ypMakefile.in	Wed Mar  8 15:40:25 2000
@@ -26,16 +26,16 @@
 # entries) in the NIS password database, for security. MINUID is the
 # lowest uid that will be included in the password maps.
 # MINGID is the lowest gid that will be included in the group maps.
-MINUID=100
-MINGID=100
+MINUID=1000
+MINGID=1000
 
 # Should we merge the passwd file with the shadow file ?
 # MERGE_PASSWD=true|false
-MERGE_PASSWD=true
+MERGE_PASSWD=false
 
 # Should we merge the group file with the gshadow file ?
 # MERGE_GROUP=true|false
-MERGE_GROUP=true
+MERGE_GROUP=false
 
 # These are commands which this Makefile needs to properly rebuild the
 # NIS databases. Don't change these unless you have a good reason.
@@ -86,6 +86,7 @@
 TIMEZONE    = $(YPSRCDIR)/timezone
 LOCALE      = $(YPSRCDIR)/locale
 NETMASKS    = $(YPSRCDIR)/netmasks
+OLDPASSWD   = $(YPSRCDIR)/security/opasswd
 
 YPSERVERS = $(YPDIR)/ypservers	# List of all NIS servers for a domain
 
@@ -99,7 +100,7 @@
 # them out from this list.
 
 all:  passwd group hosts rpc services netid protocols netgrp mail \
-	shadow publickey # networks ethers bootparams printcap \
+	shadow opasswd # publickey networks ethers bootparams printcap \
 	# amd.home auto.master auto.home auto.local passwd.adjunct \
 	# timezone locale netmasks
 
@@ -136,6 +137,7 @@
 timezone:      timezone.byname
 locale:                locale.byname
 netmasks:      netmasks.byaddr
+opasswd:	opasswd.byname opasswd.byuid
 
 ypservers: $(YPSERVERS) $(YPDIR)/Makefile
 	@echo "Updating $@..."
@@ -434,6 +436,23 @@
 		   else \
 		      printf("%s ",$$i);\
 		}' | $(DBLOAD) -i $(AMD_HOME) -o $(YPMAPDIR)/$@ - $@
+	-@$(NOPUSH) || $(YPPUSH) -d $(DOMAIN) $@
+
+opasswd.byname: $(OLDPASSWD) $(YPDIR)/Makefile
+	@echo "Updating $@..."
+	@$(UMASK); \
+	$(AWK) -F: '!/^[-+#]/ { if ($$1 != "" && $$2 >= $(MINUID) ) \
+	   print $$1"\t"$$0 }' $(OLDPASSWD) | $(DBLOAD) -i $(OLDPASSWD) \
+		-o $(YPMAPDIR)/$@ - $@
+	-@$(NOPUSH) || $(YPPUSH) -d $(DOMAIN) $@
+
+
+opasswd.byuid: $(OLDPASSWD) $(YPDIR)/Makefile
+	@echo "Updating $@..."
+	@$(UMASK); \
+	$(AWK) -F: '!/^[-+#]/ { if ($$1 != "" && $$2 >= $(MINUID) ) \
+	   print $$2"\t"$$0 }' $(OLDPASSWD) | $(DBLOAD) -i $(OLDPASSWD) \
+		 -o $(YPMAPDIR)/$@ - $@
 	-@$(NOPUSH) || $(YPPUSH) -d $(DOMAIN) $@
 
 timezone.byname: $(TIMEZONE) $(YPDIR)/Makefile
