diff -urN ypserv-1.3.12.orig/yp_db.c ypserv-1.3.12/yp_db.c
--- ypserv-1.3.12.orig/yp_db.c	Sun Nov 21 14:56:37 1999
+++ ypserv-1.3.12/yp_db.c	Sat Nov 30 20:35:07 2002
@@ -331,10 +331,12 @@
 	  /* Good, we have a free entry and don't need to close a map */
 	  int j;
 	  Fopen tmp;
+	  
+	  if ((fast_open_files[x].dbp = _db_open (domain, map)) == NULL)
+	    return NULL;
 	  fast_open_files[x].domain = strdup (domain);
 	  fast_open_files[x].map = strdup (map);
 	  fast_open_files[x].flag |= F_OPEN_FLAG;
-	  fast_open_files[x].dbp = _db_open (domain, map);
 
 	  if (debug_flag)
 	    yp_msg ("Opening: %s/%s (%d) %x\n", domain, map, x,
